# æ™ºèƒ½äººå£°åˆ†å‰²å™¨é…ç½®æ–‡ä»¶ (v2.0.0 çº¯äººå£°æ£€æµ‹å¢å¼ºç‰ˆ)
# ç›®æ ‡ï¼šåŸºäºçº¯äººå£°æ£€æµ‹ç³»ç»Ÿè§£å†³é«˜é¢‘æ¢æ°”è¯¯åˆ¤é—®é¢˜ï¼Œæ˜¾è‘—æå‡åˆ†å‰²è´¨é‡
# v1.2.0: BPMé©±åŠ¨çš„åŠ¨æ€å‚æ•°è°ƒæ•´ç³»ç»Ÿ
# v2.0.0: çº¯äººå£°æ£€æµ‹ + é¢‘è°±æ„ŸçŸ¥åˆ†ç±» + å¤šçº§éªŒè¯ç³»ç»Ÿ

# ============================================================================
# çº¯äººå£°æ£€æµ‹ç³»ç»Ÿ v2.0 é…ç½® (NEW)
# è§£å†³é«˜é¢‘æ¢æ°”è¯¯åˆ¤é—®é¢˜çš„æ ¸å¿ƒé…ç½®
# ============================================================================
pure_vocal_detection:
  # ç³»ç»Ÿå¼€å…³
  enable: true  # å¯ç”¨çº¯äººå£°æ£€æµ‹ç³»ç»Ÿv2.0

  # åŸºç¡€æ£€æµ‹å‚æ•°
  min_pause_duration: 0.5         # æœ€å°åœé¡¿æ—¶é•¿(ç§’)
  breath_duration_range: [0.1, 0.3]  # æ¢æ°”æ—¶é•¿èŒƒå›´(ç§’)

  # ç‰¹å¾æƒé‡é…ç½®
  f0_weight: 0.30                 # åŸºé¢‘ç‰¹å¾æƒé‡
  formant_weight: 0.25            # å…±æŒ¯å³°ç‰¹å¾æƒé‡
  spectral_weight: 0.25           # é¢‘è°±ç‰¹å¾æƒé‡
  duration_weight: 0.20           # æ—¶é•¿ç‰¹å¾æƒé‡

  # æ£€æµ‹é˜ˆå€¼
  energy_threshold_db: -40        # èƒ½é‡é˜ˆå€¼(dB)
  f0_drop_threshold: 0.7          # F0ä¸‹é™é˜ˆå€¼
  breath_filter_threshold: 0.3    # æ¢æ°”è¿‡æ»¤é˜ˆå€¼
  pause_confidence_threshold: 0.7  # åœé¡¿ç½®ä¿¡åº¦é˜ˆå€¼

# é¢‘è°±æ„ŸçŸ¥åˆ†ç±»å™¨é…ç½®
spectral_classifier:
  # åˆ†ç±»é˜ˆå€¼
  breath_threshold: 0.3           # æ¢æ°”åˆ†ç±»é˜ˆå€¼
  pause_threshold: 0.7            # åœé¡¿åˆ†ç±»é˜ˆå€¼
  uncertain_range: [0.3, 0.7]    # ä¸ç¡®å®šèŒƒå›´

  # ç‰¹å¾æƒé‡
  f0_weight: 0.25
  formant_weight: 0.20
  spectral_weight: 0.20
  duration_weight: 0.20
  energy_weight: 0.15

# BPMäººå£°ä¼˜åŒ–å™¨é…ç½®
bpm_vocal_optimizer:
  # èŠ‚æ‹å¯¹é½
  enable_beat_alignment: true     # å¯ç”¨èŠ‚æ‹å¯¹é½
  beat_snap_tolerance: 0.1        # èŠ‚æ‹å¸é™„å®¹å·®(ç§’)

  # é£æ ¼é€‚é…
  enable_style_adaptation: true   # å¯ç”¨é£æ ¼é€‚é…

  # æ—¶é•¿æ§åˆ¶
  target_segment_range: [8, 15]   # ç›®æ ‡ç‰‡æ®µæ—¶é•¿èŒƒå›´(ç§’)
  min_segment_duration: 3.0       # æœ€å°ç‰‡æ®µæ—¶é•¿
  max_segment_duration: 20.0      # æœ€å¤§ç‰‡æ®µæ—¶é•¿

# å¤šçº§éªŒè¯ç³»ç»Ÿé…ç½®
validator:
  # éªŒè¯é˜ˆå€¼
  min_pause_duration: 0.3         # æœ€å°åœé¡¿æ—¶é•¿
  max_pause_duration: 5.0         # æœ€å¤§åœé¡¿æ—¶é•¿
  energy_drop_threshold: 0.5      # èƒ½é‡ä¸‹é™é˜ˆå€¼
  spectral_consistency_threshold: 0.7  # é¢‘è°±ä¸€è‡´æ€§é˜ˆå€¼
  context_coherence_threshold: 0.6     # ä¸Šä¸‹æ–‡ä¸€è‡´æ€§é˜ˆå€¼
  music_theory_compliance: 0.7    # éŸ³ä¹ç†è®ºç¬¦åˆåº¦é˜ˆå€¼

  # éªŒè¯æƒé‡
  duration_weight: 0.15           # æ—¶é•¿éªŒè¯æƒé‡
  energy_weight: 0.20             # èƒ½é‡éªŒè¯æƒé‡
  spectral_weight: 0.20           # é¢‘è°±éªŒè¯æƒé‡
  context_weight: 0.20            # ä¸Šä¸‹æ–‡éªŒè¯æƒé‡
  music_theory_weight: 0.25       # éŸ³ä¹ç†è®ºéªŒè¯æƒé‡

# ============================================================================
# BPMé©±åŠ¨çš„è‡ªé€‚åº”æ ¸å¿ƒé…ç½® (v1.2.0)
# ============================================================================
bpm_adaptive_core:
  # åŸºç¡€æ—¶é—´å•ä½ï¼šä»¥èŠ‚æ‹ä¸ºåŸºå‡†
  tempo_categories:
    slow:      { min: 0,   max: 70,  label: "å·´æ‹‰å¾·/æ°‘è°£" }
    medium:    { min: 70,  max: 100, label: "æµè¡Œ/æ‘‡æ»š" }
    fast:      { min: 100, max: 140, label: "èˆæ›²/ç”µéŸ³" }
    very_fast: { min: 140, max: 999, label: "Drum&Bass" }

  # æ¢æ°”åœé¡¿(ä»¥æ‹ä¸ºå•ä½)
  pause_duration_beats:
    slow: 1.5      # æ…¢æ­Œ1.5æ‹æ¢æ°”æ—¶é—´
    medium: 1.0    # ä¸­é€Ÿ1æ‹
    fast: 0.75     # å¿«æ­Œ0.75æ‹
    very_fast: 0.5 # æå¿«0.5æ‹

  # è¾¹ç•Œä¿æŠ¤(ä»¥æ‹ä¸ºå•ä½)
  speech_pad_beats:
    slow: 0.8      # 0.8æ‹è¾¹ç•Œä¿æŠ¤
    medium: 0.5    # 0.5æ‹
    fast: 0.3      # 0.3æ‹
    very_fast: 0.2 # 0.2æ‹

  # åˆ†å‰²é—´éš™(ä»¥ä¹å¥ä¸ºå•ä½)
  split_gap_phrases:
    slow: 4        # æ…¢æ­Œ4æ‹ä¸€ä¸ªä¹å¥
    medium: 4      # ä¸­é€Ÿ4æ‹
    fast: 8        # å¿«æ­Œ8æ‹(ç´§å‡‘)
    very_fast: 8   # æå¿«8æ‹

  # å¤æ‚åº¦è¡¥å¿ç³»æ•°
  complexity_compensation:
    base_factor: 1.0           # åŸºç¡€ç³»æ•°
    complexity_boost: 0.5      # å¤æ‚åº¦å¢å¼º(æœ€å¤§+50%)
    instrument_boost: 0.15     # æ¯å¢åŠ 1ç§ä¹å™¨+15%
    min_instruments: 2         # 2ç§ä¹å™¨ä»¥ä¸‹ä¸è¡¥å¿

  # ============================================================================
  # BPMè‡ªé€‚åº”ç³»ç»Ÿä½¿ç”¨è¯´æ˜ (v1.2.0)
  # ============================================================================
  #
  # æœ¬ç³»ç»Ÿå°†æ ¹æ®éŸ³ä¹çš„BPMã€ç¼–æ›²å¤æ‚åº¦å’Œä¹å™¨æ•°é‡ï¼ŒåŠ¨æ€è®¡ç®—ä»¥ä¸‹å‚æ•°ï¼š
  #
  # 1. åœé¡¿æ—¶é•¿ = pause_duration_beats[category] Ã— beat_interval Ã— compensation
  # 2. è¾¹ç•Œä¿æŠ¤ = speech_pad_beats[category] Ã— beat_interval
  # 3. åˆ†å‰²é—´éš™ = split_gap_phrases[category] Ã— beat_interval
  # 4. VADé˜ˆå€¼ = base_threshold + complexity Ã— 0.3
  #
  # å…¶ä¸­ï¼š
  # - beat_interval = 60.0 / BPM (èŠ‚æ‹é—´éš”ç§’æ•°)
  # - compensation = complexity_factor Ã— instrument_factor
  # - category âˆˆ {slow, medium, fast, very_fast}
  #
  # åŠ¨æ€å‚æ•°å°†è¦†ç›–æ‰€æœ‰æ ‡è®°ä¸ºâŒçš„é™æ€é…ç½®å€¼ï¼Œå®ç°çœŸæ­£çš„éŸ³ä¹æ„ŸçŸ¥åˆ†å‰²ã€‚
  # ============================================================================

# ============================================================================
# æ ¸å¿ƒéŸ³é¢‘è®¾ç½®
# ============================================================================
audio:
  sample_rate: 44100              # æ ‡å‡†é‡‡æ ·ç‡ï¼Œä¿è¯Demucså’ŒBPMæ£€æµ‹ç²¾åº¦
  channels: 1
  format: 'wav'
  quality: 320

# ============================================================================
# Silero VAD é«˜çº§é…ç½® (v1.2.0 - BPMè‡ªé€‚åº”å¢å¼º)
# ============================================================================
advanced_vad:
  # ---- åŸºæœ¬é—¨é™ä¸æ—¶é—´çª— ----
  silero_target_sample_rate: 16000      # Silero VADå†…éƒ¨é‡é‡‡æ ·ç›®æ ‡

  # ğŸ”„ ä»¥ä¸‹å‚æ•°å°†è¢«BPMè‡ªé€‚åº”ç³»ç»ŸåŠ¨æ€è¦†ç›– (v1.2.0+)
  silero_min_silence_ms: 700           # âŒ é™æ€å€¼ï¼Œå°†è¢«pause_duration_beatsåŠ¨æ€è®¡ç®—è¦†ç›–
  silero_min_speech_ms: 250            # âŒ é™æ€å€¼ï¼Œå°†è¢«BPMå’Œå¤æ‚åº¦åŠ¨æ€è°ƒæ•´
  silero_speech_pad_ms: 150             # âŒ é™æ€å€¼ï¼Œå°†è¢«speech_pad_beatsåŠ¨æ€è®¡ç®—è¦†ç›–

  # âœ… ä»¥ä¸‹å‚æ•°ä¿æŒé™æ€é…ç½®
  silero_window_size_samples: 512       # 16k Ã— 30ms (å›ºå®šå¸§é•¿)

  # ---- æ¦‚ç‡æ»å› + è¿ç»­å¸§ï¼ˆå¼ºé˜²æŠ–ï¼‰----
  silero_prob_threshold_up: 0.60        # é™éŸ³->è¯­éŸ³
  silero_prob_threshold_down: 0.35      # â†“ è¯­éŸ³->é™éŸ³ï¼ˆé™ä½ï¼Œå»¶åè½¬é™éŸ³æ—¶åˆ»ï¼‰
  silero_min_consecutive_silence_frames: 20  # 40 Ã— 30ms â‰ˆ 1.2s æŒç»­é™éŸ³
  silero_min_consecutive_speech_frames: 5   # 12 Ã— 30ms â‰ˆ 0.36s
  silero_hangover_ms: 120               # â˜… è¯­éŸ³æŒ‚èµ·å»¶æ—¶ï¼šæ£€æµ‹é™ä¸ºé™éŸ³åä»ä¿æŒè¯­éŸ³æ€ 300ms
  silero_prob_smoothing_ms: 90         # â˜… æ¦‚ç‡å¹³æ»‘ï¼ˆEMA/ä¸­å€¼æ»¤æ³¢çš†å¯ï¼‰

  # ---- å¤‡ç”¨ WebRTC VAD ----
  webrtc_aggressiveness: 1

# ============================================================================
# è´¨é‡æ§åˆ¶ (v1.2.0 - BPMæ„ŸçŸ¥è´¨é‡æ§åˆ¶)
# ============================================================================
quality_control:
  validate_split_points: true

  # ğŸ”„ ä»¥ä¸‹å‚æ•°å°†è¢«BPMè‡ªé€‚åº”ç³»ç»ŸåŠ¨æ€è¦†ç›– (v1.2.0+)
  min_pause_at_split: 1.0                # âŒ é™æ€å€¼ï¼Œå°†è¢«pause_duration_beatsåŠ¨æ€è®¡ç®—è¦†ç›–
  min_split_gap: 2.5                     # âŒ é™æ€å€¼ï¼Œå°†è¢«split_gap_phrasesåŠ¨æ€è®¡ç®—è¦†ç›–

  # âœ… ä»¥ä¸‹å‚æ•°ä¿æŒé™æ€é…ç½® (ä¸éŸ³ä¹ç‰¹å¾æ— å…³)
  min_vocal_content_ratio: 0.5           # äººå£°å†…å®¹æ¯”ä¾‹è¦æ±‚
  max_silence_ratio: 0.55                # é™éŸ³æ¯”ä¾‹ä¸Šé™
  max_vocal_at_split: 0.10               # â†“ åˆ‡ç‚¹äººå£°èƒ½é‡æ›´ä¸¥ï¼Œé¿å…"å˜´ä¸Šåˆ‡"
  enable_zero_crossing_align: true       # é›¶äº¤å‰å¯¹é½å¯ç”¨

  # ---- æœªæ¥é™é»˜å®ˆå«ï¼ˆç¦»çº¿åœºæ™¯å¯ç”¨ï¼Œå¼ºåŠ›é¿å…æ—©åˆ‡ï¼‰----
  post_silence_guard_ms: 1000            # â˜… å€™é€‰åˆ‡ç‚¹ä¹‹åè‡³å°‘ 1000ms ä»éœ€ä¿æŒé™éŸ³
  bilateral_guard_ms: 0                   # å·¦å³åŒä¾§å®ˆå«ï¼ˆä¿ç•™æ¥å£ï¼Œé»˜è®¤ 0ï¼‰
  energy_floor_dbfs: -55                  # é™éŸ³å¹³å°èƒ½é‡åœ°æ¿ï¼ˆdBFSï¼‰

  # === é›¶å¤„ç†æ¨¡å¼ï¼ˆä¿æŒæ³¢å½¢ä¸€è‡´æ€§ï¼‰===
  fade_in_duration: 0.0
  fade_out_duration: 0.0
  normalize_audio: false
  remove_click_noise: false
  smooth_transitions: false
  min_segment_duration: null
  max_segment_duration: null

# ============================================================================
# BPM è‡ªé€‚åº”æ— ç¼åˆ†å‰² (v1.2.0 - å®Œå…¨åŠ¨æ€å‚æ•°é©±åŠ¨)
# ============================================================================
vocal_pause_splitting:
  # ---- æ ¸å¿ƒåˆ†å‰²å‚æ•° ----
  # ğŸ”„ ä»¥ä¸‹å‚æ•°å°†è¢«BPMè‡ªé€‚åº”ç³»ç»ŸåŠ¨æ€è¦†ç›– (v1.2.0+)
  min_pause_duration: 1.2               # âŒ é™æ€å€¼ï¼Œå°†è¢«pause_duration_beatsåŠ¨æ€è®¡ç®—è¦†ç›–
  voice_threshold: 0.50                  # âŒ é™æ€å€¼ï¼Œå°†è¢«å¤æ‚åº¦è‡ªé€‚åº”é˜ˆå€¼è¦†ç›–

  # âœ… ä»¥ä¸‹å‚æ•°ä¿æŒé™æ€é…ç½® (ä¸BPMæ— å…³çš„åˆ‡å‰²ç­–ç•¥)
  head_offset: -0.5                      # å¤´éƒ¨åˆ‡å‰²ï¼šå›æ’¤ 0.5sï¼ˆå›å½’äº§å“è§„èŒƒï¼‰
  tail_offset: 0.8                       # å°¾éƒ¨åˆ‡å‰²ï¼šå»¶å 0.8sï¼ˆæ›´æŠ—æ—©åˆ‡ï¼‰

  # ---- VAD é€‰æ‹©ä¸è®¾ç½® ----
  vad_method: "silero"                   # VADæ–¹æ³•é€‰æ‹©
  min_confidence: 0.65
  zero_processing: true
  preserve_original: true

  # ---- åˆ‡ç‚¹ç²¾ä¿®æŠ¤æ ï¼ˆä»¥é™éŸ³ä¸­å¿ƒä¸ºé”šï¼Œå³åå¾®è°ƒï¼‰----
  enable_zero_crossing_align: true
  max_shift_from_silence_center: 0.08    # â†â†’ æœ€å¤§åç§»ï¼ˆç§’ï¼‰
  silence_center_bias_ratio: 0.10        # â˜… åœ¨é™éŸ³å¹³å°å†…ï¼Œå–"å¹³å°å®½åº¦Ã—0.1"çš„å·¦åä½ç½®ï¼ˆæ›´å®‰å…¨ï¼‰
  require_silence_plateau_ms: 400        # â†‘ å¿…é¡»å¤„äºè‡³å°‘ 400ms çš„å¹³å¦é™éŸ³å¹³å°
  plateau_flatness_db: 6                 # â†‘ å¹³å¦åº¦æ›´ä¸¥æ ¼
  boundary_backoff_ms: 180               # â†‘ ä¸´è¿‘äººå£°è¾¹ç•Œæ—¶å‘é™éŸ³ä¸­å¿ƒå›é€€è·ç¦»


  # ---- æ— é™éŸ³å¹³å°çš„è°·å€¼åˆ‡å‰²ï¼ˆæœ€å°å¯ç”¨ç‰ˆï¼‰----
  enable_valley_mode: false              # æ‰‹åŠ¨å¯ç”¨è°·å€¼åˆ‡å‰²ä¼˜å…ˆ
  auto_valley_fallback: true             # å½“é™é»˜å®ˆå«/å¹³å°ä¸æ»¡è¶³æ—¶è‡ªåŠ¨å…œåº•åˆ°è°·å€¼
  local_rms_window_ms: 25                # å±€éƒ¨RMSçª—é•¿
  silence_floor_percentile: 5            # åŠ¨æ€åœ°æ¿çš„åˆ†ä½æ•°ï¼ˆç™¾åˆ†æ•°ï¼‰
  lookahead_guard_ms: 120                # æœªæ¥é™é»˜å®ˆå«ï¼ˆä»…fallbackè·¯å¾„å¼ºåˆ¶ï¼‰
  min_valley_width_ms: 100               # è°·å®½çº¦æŸï¼ˆå€™é€‰è°·çš„æœ€å°å®½åº¦ï¼‰ï¼Œå»ºè®® 100â€“160ms
  cut_at_speech_end: false               # äººå£°æ¶ˆå¤±å³åˆ‡å‰²ï¼ˆå…³é—­ï¼Œé¿å…é”™åˆ‡ï¼‰
  bpm_guard:
    enable: false                        # æ˜¯å¦å¯ç”¨æ‹ç‚¹ç¦åˆ‡ï¼›é»˜è®¤å…³é—­ï¼Œé¿å…ç ´åå…¼å®¹
    forbid_ms: 100                       # æ‹ç‚¹Â±forbid_ms ç¦åˆ‡çª—å£


  # ---- è¿ç»­äººå£°æ®µçš„ valley æ‰«æï¼ˆå¯é€‰ï¼Œé»˜è®¤å…³é—­ï¼Œé›¶ç ´åï¼‰----
  voiced_valley_fallback:
    enable: true                    # å¯¹é•¿è¯­éŸ³æ®µæŒ‰ç½‘æ ¼æ‰«æ valley å¹¶è¡¥åˆ‡ç‚¹
    min_gap_s: 6.0                   # ç½‘æ ¼é—´éš”ï¼ˆç§’ï¼‰ï¼ŒåŒæ—¶ä½œä¸ºæœ€å°åˆ‡ç‚¹é—´éš”
    min_valley_width_ms: 120         # è°·å®½è¦æ±‚ï¼ˆä¸ä¸Šæ–¹ä¿æŒä¸€è‡´ï¼‰
    window_s: 0.30                   # åˆæˆåœé¡¿çª—å£å®½åº¦ï¼ˆå›´ç»• valley Â±window/2ï¼‰

  # ==========================================================================
  # BPM è‡ªé€‚åº”ï¼ˆåªåœ¨é™éŸ³å¹³å°å†…å¾®å¸é™„ï¼Œä¸”ç¦æ­¢æå‰å¸é™„ï¼‰
  # ==========================================================================
  enable_bpm_adaptation: true

  bpm_adaptive_settings:
    # ---- BPM åˆ†æå‚æ•° ----
    tempo_analysis_window: 30.0
    tempo_min_bpm: 60
    tempo_max_bpm: 190
    tempo_prior: 120

    # ---- BPM åˆ†ç±»é˜ˆå€¼ ----
    slow_bpm_threshold: 80
    fast_bpm_threshold: 120

    # ---- èŠ‚æ‹å¯¹é½ï¼ˆä¸¥æ§ï¼šä¸å¯å‘å·¦æå‰ï¼‰----
    enable_beat_alignment: true
    beat_alignment_tolerance: 0.08       # è¿›ä¸€æ­¥é™ä½å®¹å·®ï¼Œæé«˜èŠ‚æ‹å¯¹é½ç²¾åº¦
    min_beat_strength: 0.50              # æé«˜èŠ‚æ‹å¼ºåº¦è¦æ±‚ï¼Œç¡®ä¿å¯é å¯¹é½
    beat_align_mode: "snap_within_silence"
    beat_snap_direction: "right_only"    # â˜… åªå…è®¸é å³å¸é™„ï¼Œç¦æ­¢å‘å·¦æå‰
    beat_cannot_advance: true            # â˜… å¸é™„ä¸å¾—æ—©äºé™éŸ³ä¸­å¿ƒ
    prefer_fraction_of_beat: "1/2"
    max_snap_distance_of_beat_fraction: 0.08

    # ---- å¤æ‚åº¦è‡ªé€‚åº”ï¼ˆä»…è°ƒé˜ˆï¼Œä¸ç ´åº•çº¿ï¼‰----
    enable_complexity_adaptation: true
    complexity_segments: 5
    max_threshold_boost: 0.2
    min_threshold_reduction: 0.15

    # ---- åœé¡¿æ—¶é•¿ä¹˜æ•°ï¼ˆå¸¦æ€»ä¸‹é™é’³åˆ¶ï¼‰----
    pause_duration_multipliers:
      slow_song_multiplier: 1.20         # æ…¢ï¼š1.2Ã—1.1=1.32sï¼ˆé™ä½ä¹˜æ•°é¿å…è¿‡åº¦å»¶é•¿ï¼‰
      fast_song_multiplier: 0.80         # å¿«ï¼š1.2Ã—0.9=1.08sï¼ˆæ›´ä¸¥æ ¼çš„å¿«æ­Œæ£€æµ‹ï¼‰
      medium_song_multiplier: 1.00
    min_pause_duration_floor: 0.60       # â˜… å¼ºé’³åˆ¶ï¼šä»»ä½•è‡ªé€‚åº”åä»ä¸å¾— < 1.10s

    # ---- åˆ‡å‰²åç§»ä¹˜æ•°ï¼ˆä»¥ Â±0.5/0.8 ä¸ºåŸºå‡†è½»å¾®ç¼©æ”¾ï¼‰----
    offset_multipliers:
      slow_song_offset_multiplier: 1.10  # æ…¢ï¼šhead -0.55 / tail +0.88
      fast_song_offset_multiplier: 0.95  # å¿«ï¼šhead -0.475 / tail +0.76
      medium_song_offset_multiplier: 1.00

# ============================================================================
# æ£€æµ‹ä¸“ç”¨å¢å¼ºåˆ†ç¦»å™¨ (v1.1.4+) - ğŸ†• RTX 5060 Ti 12GBä¼˜åŒ–é…ç½®
# ============================================================================
enhanced_separation:
  # åˆ†ç¦»å™¨é€‰æ‹©ï¼šmdx23(æ¨è) / demucs_v4
  backend: "mdx23"                         # ğŸš€ GPUæ¨¡å¼ï¼šä½¿ç”¨MDX23é«˜è´¨é‡åˆ†ç¦»
  enable_fallback: true                    # å¯ç”¨åç«¯é™çº§
  min_separation_confidence: 0.3          # âœ… æé«˜é—¨æ§›ç¡®ä¿é«˜è´¨é‡åˆ†ç¦»ï¼ˆMDX23/Demucsï¼‰

  # ğŸ†• GPUé…ç½® (RTX 5060 Ti 16GB, é™åˆ¶12GB)
  gpu_config:
    enable_gpu: true                       # å¯ç”¨GPUåŠ é€Ÿ
    memory_threshold: 12288                # GPUå†…å­˜é˜ˆå€¼ (12GB)
    large_gpu_mode: true                   # å¤§GPUæ¨¡å¼
    clear_cache_after_separation: true     # åˆ†ç¦»åæ¸…ç†ç¼“å­˜
    device_id: 0                          # GPUè®¾å¤‡ID

  # ğŸ†• MDX23 GPUä¼˜åŒ–é…ç½®
  mdx23:
    large_gpu: true                        # å¤§GPUæ¨¡å¼ (8GB+ VRAM)
    chunk_size: 1048576                    # å¤„ç†å—å¤§å° (1MB, å¤§GPU)
    overlap: 0.25                          # é‡å ç‡ (25%)
    timeout: 600                           # è¶…æ—¶æ—¶é—´ (10åˆ†é’Ÿ)
    use_gpu: true                          # å¼ºåˆ¶ä½¿ç”¨GPU
    gpu_memory_limit: 12288                # GPUå†…å­˜é™åˆ¶ (MB)

  # ğŸ†• Demucs v4 GPUä¼˜åŒ–é…ç½®
  demucs_v4:
    device: "cuda"                         # CUDAè®¾å¤‡
    segment: 40                            # åˆ†æ®µé•¿åº¦ (å¤§GPU: 40)
    shifts: 1                              # é¢„æµ‹æ¬¡æ•° (æé«˜è´¨é‡)
    overlap: 0.25                          # é‡å ç‡
    split: true                            # å¯ç”¨åˆ†å‰²å¤„ç†
    jobs: 1                                # å¹¶è¡Œä»»åŠ¡æ•°

  # MDX23ä¸“ç”¨é…ç½® (v1.2.0 - GPUåŠ é€Ÿä¼˜åŒ–ç‰ˆ)
  mdx23:
    project_path: "./MVSEP-MDX23-music-separation-model"  # MDX23é¡¹ç›®è·¯å¾„ï¼ˆå·²å…‹éš†åˆ°æœ¬åœ°ï¼‰
    model_name: "MDX23C_D1581"             # é»˜è®¤æ¨¡å‹åç§°
    model_path: "./models"                 # æ¨¡å‹å­˜å‚¨è·¯å¾„(é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½)
    enable_gpu: true                       # âœ… ä½¿ç”¨GPUåŠ é€Ÿ
    enable_large_gpu: false                # âš¡ å…³é—­å¤§å‹GPUæ¨¡å¼ä»¥èŠ‚çœæ˜¾å­˜ï¼ˆRTX 5060 Ti 16GBé€‚é…ï¼‰
    use_single_onnx: false                 # ä½¿ç”¨å®Œæ•´æ¨¡å‹è·å¾—æœ€ä½³è´¨é‡
    timeout: 180                           # âš¡ å‡å°‘è¶…æ—¶æ—¶é—´ï¼ˆGPUæ¨¡å¼ä¸‹æ›´å¿«ï¼‰
    executable_path: "python inference.py" # å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„
    chunk_size: 100000                     # âš¡ é™ä½chunk sizeä»¥é€‚é…16GBæ˜¾å­˜
    overlap_large: 0.25                    # âš¡ å¹³è¡¡è´¨é‡å’Œé€Ÿåº¦çš„é‡å åº¦
    overlap_small: 0.1                     # è½»é‡æ¨¡å‹é‡å åº¦

  # Demucs v4é…ç½® (GPUåŠ é€Ÿä¼˜åŒ–ç‰ˆ)
  demucs_v4:
    model: "htdemucs"                      # æ¨¡å‹åç§°
    device: "cuda"                         # âš¡ å¼ºåˆ¶ä½¿ç”¨CUDAï¼Œå¦‚æœä¸å¯ç”¨ä¼šè‡ªåŠ¨é™çº§åˆ°CPU
    segment: 4                             # âš¡ é™ä½åˆ†æ®µä»¥é€‚é…16GBæ˜¾å­˜ï¼Œé¿å…å†…å­˜é”™è¯¯
    overlap: 0.25                          # é‡å åº¦ï¼Œå¹³è¡¡è´¨é‡å’Œé€Ÿåº¦
    shifts: 1                              # éŸ³é¢‘åç§»æ•°é‡ï¼Œ1=æœ€å¿«ï¼Œ10=æœ€å‡†ç¡®
    split: true                            # å¯ç”¨æ™ºèƒ½åˆ†æ®µå¤„ç†

  # åŒè·¯æ£€æµ‹é…ç½® (v1.2.0 ä¼˜åŒ–ç‰ˆ)
  dual_detection:
    enable_cross_validation: true          # å¯ç”¨äº¤å‰éªŒè¯ä»¥è·å¾—æ›´å¥½çš„æ£€æµ‹æ•ˆæœ
    pause_matching_tolerance: 0.12         # âœ… è¿›ä¸€æ­¥é™ä½å®¹å·®ï¼Œæå‡åœé¡¿åŒ¹é…ç²¾åº¦
    confidence_boost_factor: 1.15          # âœ… å¢åŠ ç½®ä¿¡åº¦æå‡ç³»æ•°
    mixed_audio_weight: 0.25               # âœ… è¿›ä¸€æ­¥é™ä½æ··éŸ³æ£€æµ‹æƒé‡ï¼Œæ›´ä¿¡ä»»åˆ†ç¦»ç»“æœ
    require_both_paths: false              # âœ… ä¸å¼ºåˆ¶è¦æ±‚ä¸¤ä¸ªè·¯å¾„éƒ½æ£€æµ‹åˆ°ï¼Œå…è®¸é«˜è´¨é‡å•è·¯å¾„
    separated_audio_weight: 0.7            # æé«˜Demucsåˆ†ç¦»éŸ³é¢‘æ£€æµ‹æƒé‡

# ============================================================================
# è¾“å‡ºè®¾ç½®
# ============================================================================
output:
  directory: '../output'
  naming_pattern: 'vocal_segment_{index:02d}'
  include_metadata: true
  save_debug_info: true
  save_separated_vocal: false
  save_breath_map: false
  save_analysis_report: true

# ============================================================================
# æ—¥å¿—è®¾ç½®
# ============================================================================
logging:
  level: 'INFO'
  file: 'smart_splitter.log'
  format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
  max_file_size: '10MB'
  backup_count: 3

# ============================================================================
# å†å²å…¼å®¹æ€§é…ç½® (ä¿ç•™ä»¥é¿å…å¯¼å…¥é”™è¯¯)
# ============================================================================
bpm_adaptive_settings: {}                 # ä¿®æ­£æ‹¼å†™é”™è¯¯ï¼šbpm_adaptive_settings

smart_splitting:
  use_pause_priority_algorithm: false
  use_precise_voice_algorithm: false
  min_segment_length: 5
  max_segment_length: 15
  target_segment_length: 8

vocal_separation:
  hpss_margin: 2.0              # âš¡ å¢å¤§marginä»¥åŠ å¿«åˆ†ç¦»é€Ÿåº¦
  hpss_power: 1.5               # âš¡ å¢å¤§powerä»¥æé«˜åˆ†ç¦»å¼ºåº¦
  mask_threshold: 0.2           # âš¡ é™ä½é˜ˆå€¼ä»¥æå‡é€Ÿåº¦
  mask_smoothing: 1             # âš¡ å‡å°‘å¹³æ»‘å¤„ç†ä»¥æå‡é€Ÿåº¦
  vocal_freq_min: 100           # âš¡ æé«˜æœ€ä½é¢‘ç‡ï¼Œå‡å°‘å¤„ç†èŒƒå›´
  vocal_freq_max: 4000
  vocal_core_min: 200
  vocal_core_max: 1000
  min_vocal_ratio: 0.15
  max_noise_ratio: 0.3

breath_detection:
  energy_window: 0.04
  energy_hop: 0.005
  energy_threshold: 0.018
  spectral_window: 0.08
  spectral_threshold: 0.2
  min_pause_duration: 0.8
  max_pause_duration: 3.0
  pause_merge_threshold: 0.06
  breath_energy_drop: 0.6
  breath_duration_min: 0.8
  breath_duration_max: 1.2

content_analysis:
  min_vocal_segment: 3.0
  max_vocal_segment: 30.0
  continuity_threshold: 0.5
  semantic_gap_max: 1.0
  vocal_clarity_min: 0.6
  content_completeness: 0.8

pause_priority:
  duration_weight: 0.5
  intensity_weight: 0.2
  energy_weight: 0.2
  stability_weight: 0.1
  min_split_interval: 3.0
  max_splits_per_minute: 8
  min_pause_duration: 0.1
  min_priority_score: 0.3

precise_voice_splitting:
  preferred_vad_method: "silero"
  min_silence_duration: 1.0
  min_voice_duration: 0.8
  silence_threshold: 0.15
  short_pause_duration: 0.3
  medium_pause_duration: 0.6
  long_pause_duration: 1.2
  split_in_silence_center: true
  avoid_boundary_splits: true
  boundary_buffer: 2.0
  placement_strategy: "center_internal_offset_edges"
  use_breath_pauses: false
  cut_offset_before_vocal_start: -0.5   # è´Ÿå€¼è¡¨ç¤ºåœ¨äººå£°å¼€å§‹å‰åˆ‡å‰²
  cut_offset_after_vocal_end: 0.5       # æ­£å€¼è¡¨ç¤ºåœ¨äººå£°ç»“æŸååˆ‡å‰²
  min_split_gap: 2.0
  merge_silence_below: 2.0
  min_voice_duration: 1.2
  min_vocal_content_ratio: 0.4
  max_silence_ratio: 0.3
  fade_in_duration: 0.1
  fade_out_duration: 0.1
  normalize_audio: false
  remove_click_noise: false
  smooth_transitions: false

# Time mapping configuration for cross-domain audio processing
time_mapping:
  sr_vocal: 16000      # VAD processing sample rate
  sr_raw: 44100        # Original audio sample rate
  latency_samples: 0   # Resampling latency compensation (to be measured)
