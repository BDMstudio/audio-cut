# é…ç½®æ–‡ä»¶è¿ç§»æŒ‡å— (v1.1.2)

æœ¬æ–‡æ¡£æŒ‡å¯¼ç”¨æˆ·ä»æ—§ç‰ˆæœ¬é…ç½®è¿ç§»åˆ°v1.1.2æ¸…ç†ç‰ˆæœ¬é…ç½®ã€‚

## ğŸ“‹ è¿ç§»æ¦‚è¿°

**ç‰ˆæœ¬**: v1.0.x/v1.1.0 â†’ v1.1.2
**è¿ç§»ç±»å‹**: é…ç½®ç»“æ„æ¸…ç†ä¸BPMé€»è¾‘ä¿®æ­£
**å‘åå…¼å®¹**: âœ… æ”¯æŒï¼ˆä¿ç•™åºŸå¼ƒé…ç½®æ®µä»¥é¿å…é”™è¯¯ï¼‰

## ğŸ¯ ä¸»è¦å˜åŒ–

### 1. **é…ç½®ç»“æ„é‡ç»„**
- **ä¸»é…ç½®æ®µ**: `vocal_pause_splitting` æå‡ä¸ºæ ¸å¿ƒé…ç½®
- **åºŸå¼ƒæ ‡è®°**: å†å²é…ç½®æ®µæ˜ç¡®æ ‡è®°ä¸ºåºŸå¼ƒä½†ä¿ç•™
- **æ³¨é‡Šå¢å¼º**: æ·»åŠ è¯¦ç»†çš„é…ç½®è¯´æ˜å’Œä½¿ç”¨çŠ¶æ€

### 2. **BPMé€»è¾‘ä¿®æ­£**
- **æ…¢æ­Œä¹˜æ•°**: ä»å¤šç§é”™è¯¯å€¼ â†’ 1.5ï¼ˆéŸ³ä¹ç†è®ºæ­£ç¡®ï¼‰
- **å¿«æ­Œä¹˜æ•°**: ä»å¤šç§é”™è¯¯å€¼ â†’ 0.7ï¼ˆéŸ³ä¹ç†è®ºæ­£ç¡®ï¼‰
- **é€»è¾‘å¯¹é½**: æ…¢æ­Œéœ€è¦æ›´é•¿åœé¡¿ï¼Œå¿«æ­Œå…è®¸æ›´çŸ­åœé¡¿

### 3. **æ¸…ç†åºŸå¼ƒé…ç½®**
- **ç§»é™¤é‡å¤**: åˆ é™¤é‡å¤çš„BPMé…ç½®æ®µ
- **ä¿ç•™å…¼å®¹**: åºŸå¼ƒé…ç½®ä¿ç•™ä»¥é¿å…å¯¼å…¥é”™è¯¯
- **ç»“æ„ä¼˜åŒ–**: é…ç½®æ–‡ä»¶ä»261è¡Œå‡è‡³195è¡Œæ ¸å¿ƒé…ç½®

## ğŸš€ è‡ªåŠ¨è¿ç§»

### æ–¹æ¡ˆ1: ä½¿ç”¨å¤‡ä»½é…ç½®
å¦‚æœæ‚¨æœ‰é‡è¦çš„è‡ªå®šä¹‰é…ç½®ï¼š

```bash
# 1. å¤‡ä»½å½“å‰é…ç½®
cd src/vocal_smart_splitter/
cp config.yaml config_my_custom.yaml

# 2. ä½¿ç”¨æ¸…ç†ç‰ˆæœ¬
cp config_clean.yaml config.yaml

# 3. æ‰‹åŠ¨è¿ç§»è‡ªå®šä¹‰å‚æ•°ï¼ˆè§ä¸‹æ–¹å¯¹ç…§è¡¨ï¼‰
```

### æ–¹æ¡ˆ2: å…¨æ–°å¼€å§‹
å¦‚æœæ‚¨ä½¿ç”¨é»˜è®¤é…ç½®ï¼š

```bash
# ç›´æ¥ä½¿ç”¨æ¸…ç†ç‰ˆæœ¬ï¼ˆå·²å®Œæˆï¼‰
# å½“å‰config.yamlå·²ç»æ˜¯æ¸…ç†åçš„ç‰ˆæœ¬
```

## ğŸ“Š é…ç½®å¯¹ç…§è¡¨

### æ ¸å¿ƒé…ç½®è¿ç§»

| é…ç½®é¡¹ | æ—§è·¯å¾„ | æ–°è·¯å¾„ | çŠ¶æ€ |
|-------|-------|-------|------|
| BPMè‡ªé€‚åº”å¯ç”¨ | `vocal_pause_splitting.enable_bpm_adaptation` | åŒè·¯å¾„ | âœ… ä¿æŒä¸å˜ |
| åŸºç¡€åœé¡¿æ—¶é•¿ | `vocal_pause_splitting.min_pause_duration` | åŒè·¯å¾„ | âœ… ä¿æŒä¸å˜ |
| VADæ–¹æ³• | `vocal_pause_splitting.vad_method` | åŒè·¯å¾„ | âœ… ä¿æŒä¸å˜ |
| æ…¢æ­Œä¹˜æ•° | `...pause_duration_multipliers.slow_song_multiplier` | åŒè·¯å¾„ | ğŸ”§ å€¼ä¿®æ­£: å¤šç§â†’1.5 |
| å¿«æ­Œä¹˜æ•° | `...pause_duration_multipliers.fast_song_multiplier` | åŒè·¯å¾„ | ğŸ”§ å€¼ä¿®æ­£: å¤šç§â†’0.7 |

### BPMä¹˜æ•°ä¿®æ­£å¯¹ç…§

| æ­Œæ›²ç±»å‹ | æ—§å€¼ç¤ºä¾‹ | v1.1.2æ–°å€¼ | ä¿®æ­£ç†ç”± |
|----------|----------|-----------|---------|
| æ…¢æ­Œ (BPM<80) | 0.6, 0.7, 5.7 | **1.5** | æ…¢èŠ‚å¥â†’éœ€è¦æ›´é•¿åœé¡¿é¿å…è¿‡åº¦åˆ†å‰² |
| å¿«æ­Œ (BPM>120) | 1.2, 1.3, 3.3 | **0.7** | å¿«èŠ‚å¥â†’å…è®¸æ›´çŸ­åœé¡¿é€‚åº”å¯†é›†èŠ‚æ‹ |
| ä¸­é€Ÿæ­Œ | 1.0 | **1.0** | æ ‡å‡†èŠ‚æ‹â†’ä¿æŒåŸºå‡†åœé¡¿æ—¶é•¿ |

### é…ç½®æ®µçŠ¶æ€

| é…ç½®æ®µ | v1.1.2çŠ¶æ€ | è¯´æ˜ |
|-------|-----------|------|
| `vocal_pause_splitting` | ğŸš€ **ä¸»è¦** | BPMè‡ªé€‚åº”æ— ç¼åˆ†å‰²ï¼ˆæ¨èï¼‰ |
| `quality_control` | âœ… **æ´»è·ƒ** | è´¨é‡æ§åˆ¶å’Œé›¶å¤„ç†è®¾ç½® |
| `advanced_vad` | âœ… **æ´»è·ƒ** | Silero VADæ ¸å¿ƒå‚æ•° |
| `audio`/`output`/`logging` | âœ… **æ´»è·ƒ** | åŸºç¡€ç³»ç»Ÿè®¾ç½® |
| `vocal_separation` | âš ï¸ **åºŸå¼ƒ** | äººå£°åˆ†ç¦»ï¼ˆæ— ç¼æ¨¡å¼ä¸éœ€è¦ï¼‰ |
| `breath_detection` | âš ï¸ **åºŸå¼ƒ** | æ¢æ°”æ£€æµ‹ï¼ˆè¢«Silero VADæ›¿ä»£ï¼‰ |
| `content_analysis` | âš ï¸ **åºŸå¼ƒ** | å†…å®¹åˆ†æï¼ˆä¼ ç»Ÿæ¨¡å¼ä¸“ç”¨ï¼‰ |
| `smart_splitting` | âš ï¸ **åºŸå¼ƒ** | æ™ºèƒ½åˆ†å‰²è°ƒåº¦å™¨ |
| `pause_priority` | âš ï¸ **åºŸå¼ƒ** | åœé¡¿ä¼˜å…ˆç®—æ³• |
| `precise_voice_splitting` | âš ï¸ **åºŸå¼ƒ** | ç²¾ç¡®äººå£°åˆ†å‰²ç®—æ³• |

## âš¡ æ‰‹åŠ¨è¿ç§»æ­¥éª¤

### æ­¥éª¤1: æå–è‡ªå®šä¹‰é…ç½®
å¦‚æœæ‚¨æœ‰è‡ªå®šä¹‰é…ç½®ï¼Œæå–è¿™äº›å…³é”®å‚æ•°ï¼š

```bash
# æ£€æŸ¥æ‚¨çš„è‡ªå®šä¹‰å‚æ•°
grep -E "(min_pause_duration|voice_threshold|slow_song_multiplier|fast_song_multiplier)" config_my_custom.yaml
```

### æ­¥éª¤2: åº”ç”¨åˆ°æ–°é…ç½®
åœ¨æ–°çš„ `config.yaml` ä¸­æ‰¾åˆ°å¯¹åº”ä½ç½®å¹¶æ›´æ–°ï¼š

```yaml
vocal_pause_splitting:
  min_pause_duration: [æ‚¨çš„è‡ªå®šä¹‰å€¼]    # å¦‚: 1.0
  voice_threshold: [æ‚¨çš„è‡ªå®šä¹‰å€¼]       # å¦‚: 0.45
  
  bpm_adaptive_settings:
    pause_duration_multipliers:
      slow_song_multiplier: [å»ºè®®ä½¿ç”¨1.5]   # éŸ³ä¹ç†è®ºä¿®æ­£
      fast_song_multiplier: [å»ºè®®ä½¿ç”¨0.7]   # éŸ³ä¹ç†è®ºä¿®æ­£
```

### æ­¥éª¤3: éªŒè¯é…ç½®
```bash
# æµ‹è¯•é…ç½®åŠ è½½
python -c "
import sys
sys.path.append('src')
from vocal_smart_splitter.utils.config_manager import get_config
print('é…ç½®åŠ è½½æ­£å¸¸:', get_config('vocal_pause_splitting.enable_bmp_adaptation'))
"
```

### æ­¥éª¤4: åŠŸèƒ½éªŒè¯
```bash
# è¿è¡ŒBPMè‡ªé€‚åº”æµ‹è¯•
python tests/test_bmp_adaptive_vad.py

# æˆ–è¿è¡Œå®Œæ•´åˆ†å‰²æµ‹è¯•  
python run_splitter.py input/01.mp3 --seamless-vocal
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### é—®é¢˜1: é…ç½®åŠ è½½é”™è¯¯
```bash
# æ£€æŸ¥YAMLè¯­æ³•
python -c "import yaml; yaml.safe_load(open('src/vocal_smart_splitter/config.yaml'))"
```

### é—®é¢˜2: BPMä¹˜æ•°ä¸ç”Ÿæ•ˆ
æ£€æŸ¥é…ç½®è·¯å¾„å’Œå€¼ï¼š
```bash
# éªŒè¯ä¹˜æ•°é…ç½®
python -c "
import sys
sys.path.append('src')
from vocal_smart_splitter.utils.config_manager import get_config
print('æ…¢æ­Œä¹˜æ•°:', get_config('vocal_pause_splitting.bpm_adaptive_settings.pause_duration_multipliers.slow_song_multiplier'))
print('å¿«æ­Œä¹˜æ•°:', get_config('vocal_pause_splitting.bpm_adaptive_settings.pause_duration_multipliers.fast_song_multiplier'))
"
```

### é—®é¢˜3: å¯¼å…¥é”™è¯¯
å¦‚æœé‡åˆ°å¯¼å…¥é”™è¯¯ï¼Œå¯èƒ½æ˜¯ç¼ºå°‘æŸä¸ªåºŸå¼ƒé…ç½®æ®µï¼š
```bash
# æ£€æŸ¥é”™è¯¯ä¿¡æ¯ä¸­æåˆ°çš„é…ç½®æ®µ
# å°†è¯¥æ®µä»config_backup_original.yamlå¤åˆ¶åˆ°config.yamlçš„åºŸå¼ƒåŒºåŸŸ
```

## ğŸ“ˆ è¿ç§»æ•ˆæœéªŒè¯

### é¢„æœŸæ”¹è¿›
- âœ… **é…ç½®æ¸…æ™°åº¦**: æ ¸å¿ƒé…ç½®ä¸åºŸå¼ƒé…ç½®æ˜ç¡®åˆ†ç¦»
- âœ… **éŸ³ä¹ç†è®ºå¯¹é½**: BPMä¹˜æ•°ç¬¦åˆéŸ³ä¹è§„å¾‹
- âœ… **ç»´æŠ¤æ€§æå‡**: åªéœ€å…³æ³¨æ ¸å¿ƒé…ç½®æ®µ
- âœ… **ç³»ç»Ÿç¨³å®šæ€§**: ä¿®å¤numpyæ ¼å¼åŒ–ç­‰é”™è¯¯

### éªŒè¯æŒ‡æ ‡
```bash
# 1. é…ç½®åŠ è½½é€Ÿåº¦
time python -c "from src.vocal_smart_splitter.utils.config_manager import get_config; get_config('audio')"

# 2. BPMæ£€æµ‹å‡†ç¡®æ€§
python tests/test_bmp_adaptive_vad.py | grep "BPMåˆ†ææˆåŠŸ"

# 3. åˆ†å‰²è´¨é‡
python run_splitter.py input/01.mp3 --seamless-vocal | grep "ç‰‡æ®µæ•°é‡"
```

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœè¿ç§»å‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š

```bash
# å›æ»šåˆ°åŸå§‹é…ç½®
cd src/vocal_smart_splitter/
cp config_backup_original.yaml config.yaml

# æˆ–å›æ»šåˆ°æ‚¨çš„è‡ªå®šä¹‰é…ç½®
cp config_my_custom.yaml config.yaml
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœåœ¨è¿ç§»è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æ£€æŸ¥å¤‡ä»½**: ç¡®ä¿æœ‰ `config_backup_original.yaml` å¤‡ä»½
2. **å¯¹ç…§æ–‡æ¡£**: å‚è€ƒæœ¬è¿ç§»æŒ‡å—å’Œä¸»è¦æ–‡æ¡£
3. **éªŒè¯æµ‹è¯•**: è¿è¡Œæµ‹è¯•å¥—ä»¶ç¡®è®¤ç³»ç»ŸåŠŸèƒ½
4. **é€æ­¥è°ƒè¯•**: å…ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå†é€æ­¥æ·»åŠ è‡ªå®šä¹‰å‚æ•°

---

**è¿ç§»å®Œæˆåè®°å¾—åˆ é™¤ä¸´æ—¶æ–‡ä»¶**ï¼š
```bash
# æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
rm config_clean.yaml  # è¿ç§»æ¨¡æ¿
# ä¿ç•™ config_backup_original.yaml ä½œä¸ºå¤‡ä»½
```